<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Quiz Educacional</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div id="app"></div>
    <script>
        // Dados iniciais
        let usuarios = JSON.parse(localStorage.getItem('usuarios') || '[]');
        let questoes = JSON.parse(localStorage.getItem('questoes') || '[{"id":1,"materia":"Hist√≥ria","pergunta":"Qual evento iniciou a Primeira Guerra Mundial?","opcoes":{"a":"Assassinato do Arquiduque Franz Ferdinand","b":"Invas√£o da Pol√¥nia","c":"Ataque a Pearl Harbor","d":"Revolu√ß√£o Russa"},"correta":"a","explicacao":"O assassinato do Arquiduque foi o estopim da guerra."},{"id":2,"materia":"Geografia","pergunta":"Qual √© o maior pa√≠s da Am√©rica do Sul?","opcoes":{"a":"Argentina","b":"Peru","c":"Brasil","d":"Col√¥mbia"},"correta":"c","explicacao":"Brasil √© o maior pa√≠s em extens√£o territorial."},{"id":3,"materia":"Matem√°tica","pergunta":"Quanto √© 15 x 8?","opcoes":{"a":"120","b":"130","c":"110","d":"140"},"correta":"a","explicacao":"15 x 8 = 120"},{"id":4,"materia":"Portugu√™s","pergunta":"Qual √© o plural de cidad√£o?","opcoes":{"a":"Cidad√µes","b":"Cidad√£os","c":"Cidad√£es","d":"Cidad√£oes"},"correta":"b","explicacao":"O plural correto √© cidad√£os."}]');
        let historico = JSON.parse(localStorage.getItem('historico') || '[]');
        let usuarioLogado = null;
        let tela = 'cadastro';
        let quizAtual = {materia: '', questoes: [], indice: 0, respostas: []};

        // Salvar dados
        function salvar() {
            localStorage.setItem('usuarios', JSON.stringify(usuarios));
            localStorage.setItem('questoes', JSON.stringify(questoes));
            localStorage.setItem('historico', JSON.stringify(historico));
        }

        // Renderizar
        function render() {
            const app = document.getElementById('app');
            app.innerHTML = '';
            
            if (tela === 'cadastro') {
                renderCadastro();
            } else if (tela === 'login') {
                renderLogin();
            } else if (tela === 'menu') {
                renderMenu();
            } else if (tela === 'selecionar') {
                renderSelecionar();
            } else if (tela === 'quiz') {
                renderQuiz();
            } else if (tela === 'resultado') {
                renderResultado();
            } else if (tela === 'historico') {
                renderHistorico();
            } else if (tela === 'inserir') {
                renderInserir();
            }
        }

        function renderCadastro() {
            document.getElementById('app').innerHTML = `
                <div class="min-h-screen flex items-center justify-center p-4">
                    <div class="bg-white p-8 rounded-lg shadow-lg max-w-md w-full">
                        <h1 class="text-3xl font-bold text-center mb-6 text-blue-600">üìö Cadastro</h1>
                        <select id="perfil" class="w-full p-3 border rounded mb-4" onchange="toggleProfessor()">
                            <option value="aluno">üë®‚Äçüéì Aluno</option>
                            <option value="professor">üë®‚Äçüè´ Professor</option>
                        </select>
                        <input type="text" id="nome" placeholder="Nome completo" class="w-full p-3 border rounded mb-4">
                        <input type="text" id="usuario" placeholder="Usu√°rio" class="w-full p-3 border rounded mb-4">
                        <div id="divProfessor">
                            <input type="text" id="professor" placeholder="Professor Respons√°vel" class="w-full p-3 border rounded mb-4 bg-blue-50">
                        </div>
                        <input type="password" id="senha" placeholder="Senha" class="w-full p-3 border rounded mb-4">
                        <input type="password" id="senha2" placeholder="Confirmar senha" class="w-full p-3 border rounded mb-4">
                        <button onclick="cadastrar()" class="w-full bg-blue-500 text-white p-3 rounded font-semibold hover:bg-blue-600">Criar Conta</button>
                        <button onclick="tela='login';render()" class="w-full text-blue-500 mt-4 hover:underline">J√° tenho conta - Fazer Login</button>
                    </div>
                </div>
            `;
        }

        function toggleProfessor() {
            const perfil = document.getElementById('perfil').value;
            const div = document.getElementById('divProfessor');
            div.style.display = perfil === 'aluno' ? 'block' : 'none';
        }

        function renderLogin() {
            document.getElementById('app').innerHTML = `
                <div class="min-h-screen flex items-center justify-center p-4">
                    <div class="bg-white p-8 rounded-lg shadow-lg max-w-md w-full">
                        <h1 class="text-3xl font-bold text-center mb-6 text-blue-600">üîê Login</h1>
                        <input type="text" id="usuario" placeholder="Usu√°rio" class="w-full p-3 border rounded mb-4">
                        <input type="password" id="senha" placeholder="Senha" class="w-full p-3 border rounded mb-4">
                        <button onclick="login()" class="w-full bg-blue-500 text-white p-3 rounded font-semibold hover:bg-blue-600">Entrar</button>
                        <button onclick="tela='cadastro';render()" class="w-full text-blue-500 mt-4 hover:underline">Criar nova conta</button>
                    </div>
                </div>
            `;
        }

        function renderMenu() {
            const materias = [...new Set(questoes.map(q => q.materia))];
            document.getElementById('app').innerHTML = `
                <div class="min-h-screen p-4">
                    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-6">
                        <div class="flex justify-between items-center mb-6 p-4 bg-blue-50 rounded">
                            <div>
                                <h2 class="text-lg font-semibold">${usuarioLogado.nome}</h2>
                                <p class="text-sm text-gray-600">@${usuarioLogado.usuario} ‚Ä¢ ${usuarioLogado.perfil === 'professor' ? 'üë®‚Äçüè´ Professor' : 'üë®‚Äçüéì Aluno'}</p>
                                ${usuarioLogado.professor ? `<p class="text-xs text-gray-500">Prof: ${usuarioLogado.professor}</p>` : ''}
                            </div>
                            <button onclick="sair()" class="px-4 py-2 text-red-600 border border-red-600 rounded hover:bg-red-50">Sair</button>
                        </div>
                        <h1 class="text-3xl font-bold text-center mb-8">üìñ Sistema de Quiz</h1>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <button onclick="tela='selecionar';render()" class="bg-blue-500 text-white p-6 rounded-lg hover:bg-blue-600 transition">
                                <div class="text-4xl mb-2">üìù</div>
                                <h3 class="font-semibold text-lg">Fazer Quiz</h3>
                                <p class="text-sm opacity-80">Responda quest√µes</p>
                            </button>
                            ${usuarioLogado.perfil === 'professor' ? `
                            <button onclick="tela='inserir';render()" class="bg-green-500 text-white p-6 rounded-lg hover:bg-green-600 transition">
                                <div class="text-4xl mb-2">‚ûï</div>
                                <h3 class="font-semibold text-lg">Inserir Quest√£o</h3>
                                <p class="text-sm opacity-80">Adicionar nova quest√£o</p>
                            </button>` : ''}
                            <button onclick="tela='historico';render()" class="bg-purple-500 text-white p-6 rounded-lg hover:bg-purple-600 transition">
                                <div class="text-4xl mb-2">üìä</div>
                                <h3 class="font-semibold text-lg">Hist√≥rico</h3>
                                <p class="text-sm opacity-80">Ver resultados</p>
                            </button>
                            <button onclick="gerarDOC()" class="bg-orange-500 text-white p-6 rounded-lg hover:bg-orange-600 transition">
                                <div class="text-4xl mb-2">üìÑ</div>
                                <h3 class="font-semibold text-lg">Gerar DOC</h3>
                                <p class="text-sm opacity-80">Relat√≥rio Word</p>
                            </button>
                            <button onclick="gerarCSV()" class="bg-teal-500 text-white p-6 rounded-lg hover:bg-teal-600 transition">
                                <div class="text-4xl mb-2">üìä</div>
                                <h3 class="font-semibold text-lg">Gerar Excel</h3>
                                <p class="text-sm opacity-80">Planilha CSV</p>
                            </button>
                        </div>
                        <div class="mt-6 p-4 bg-gray-50 rounded text-center">
                            <p class="text-sm text-gray-600">üìö Total: <strong>${questoes.length}</strong> quest√µes | Mat√©rias: <strong>${materias.join(', ')}</strong></p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderSelecionar() {
            const materias = [...new Set(questoes.map(q => q.materia))];
            document.getElementById('app').innerHTML = `
                <div class="min-h-screen p-4">
                    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6">
                        <h1 class="text-2xl font-bold mb-6">üìö Selecione a Mat√©ria</h1>
                        <div class="grid grid-cols-1 gap-3">
                            ${materias.map(m => {
                                const qtd = questoes.filter(q => q.materia === m).length;
                                return `<button onclick="iniciarQuiz('${m}')" class="p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition text-left">
                                    <h3 class="font-semibold text-lg">${m}</h3>
                                    <p class="text-sm text-gray-600">${qtd} quest√£o${qtd > 1 ? '√µes' : ''} dispon√≠vel${qtd > 1 ? 'is' : ''}</p>
                                </button>`;
                            }).join('')}
                        </div>
                        <button onclick="tela='menu';render()" class="w-full mt-6 p-3 border-2 border-gray-300 rounded-lg hover:bg-gray-50">Voltar</button>
                    </div>
                </div>
            `;
        }

        function renderQuiz() {
            const q = quizAtual.questoes[quizAtual.indice];
            const progresso = Math.round(((quizAtual.indice + 1) / quizAtual.questoes.length) * 100);
            
            document.getElementById('app').innerHTML = `
                <div class="min-h-screen p-4">
                    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6">
                        <div class="mb-4">
                            <div class="flex justify-between text-sm text-gray-600 mb-2">
                                <span>Quest√£o ${quizAtual.indice + 1} de ${quizAtual.questoes.length}</span>
                                <span>${progresso}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-500 h-2 rounded-full transition-all" style="width: ${progresso}%"></div>
                            </div>
                        </div>
                        
                        <div class="mb-6 p-4 bg-blue-50 rounded-lg">
                            <h2 class="text-xl font-semibold">${q.pergunta}</h2>
                        </div>
                        
                        <div class="space-y-3">
                            ${Object.keys(q.opcoes).map(k => `
                                <button onclick="responder('${k}')" class="w-full p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition text-left">
                                    <span class="font-semibold">${k.toUpperCase()}) </span>${q.opcoes[k]}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderResultado() {
            const acertos = quizAtual.respostas.filter(r => r.correta).length;
            const total = quizAtual.questoes.length;
            const perc = Math.round((acertos / total) * 100);
            
            document.getElementById('app').innerHTML = `
                <div class="min-h-screen p-4">
                    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6">
                        <h1 class="text-3xl font-bold text-center mb-6">üéØ Resultado Final</h1>
                        
                        <div class="text-center mb-8 p-6 ${perc >= 70 ? 'bg-green-50' : 'bg-red-50'} rounded-lg">
                            <div class="text-6xl font-bold ${perc >= 70 ? 'text-green-600' : 'text-red-600'}">${perc}%</div>
                            <p class="text-xl mt-2">${acertos} de ${total} quest√µes corretas</p>
                            <p class="text-lg font-semibold mt-2">${perc >= 70 ? '‚úÖ Aprovado!' : '‚ùå Voc√™ pode melhorar!'}</p>
                        </div>
                        
                        <div class="space-y-4 mb-6">
                            ${quizAtual.respostas.map((r, i) => `
                                <div class="p-4 border-2 ${r.correta ? 'border-green-300 bg-green-50' : 'border-red-300 bg-red-50'} rounded-lg">
                                    <p class="font-semibold mb-2">${i + 1}. ${r.pergunta}</p>
                                    <p class="text-sm">Sua resposta: <span class="font-semibold">${r.resposta}</span> ${r.correta ? '‚úÖ' : '‚ùå'}</p>
                                    ${!r.correta ? `<p class="text-sm text-green-700 mt-1">Correta: <span class="font-semibold">${r.opcaoCorreta}</span></p>` : ''}
                                    <p class="text-sm text-gray-600 mt-2 italic">${r.explicacao}</p>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="flex gap-3">
                            <button onclick="tela='selecionar';render()" class="flex-1 p-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Novo Quiz</button>
                            <button onclick="tela='menu';render()" class="flex-1 p-3 border-2 border-gray-300 rounded-lg hover:bg-gray-50">Menu</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderHistorico() {
            const meusRegistros = usuarioLogado.perfil === 'professor' 
                ? historico 
                : historico.filter(h => h.login === usuarioLogado.usuario);
            
            document.getElementById('app').innerHTML = `
                <div class="min-h-screen p-4">
                    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-6">
                        <h1 class="text-2xl font-bold mb-6">üìä Hist√≥rico de Resultados</h1>
                        
                        ${meusRegistros.length === 0 ? `
                            <p class="text-center text-gray-500 py-8">Nenhum resultado ainda. Fa√ßa um quiz!</p>
                        ` : `
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-100">
                                        <tr>
                                            <th class="p-3 text-left">Data</th>
                                            <th class="p-3 text-left">Aluno</th>
                                            <th class="p-3 text-left">Mat√©ria</th>
                                            <th class="p-3 text-center">Acertos</th>
                                            <th class="p-3 text-center">%</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${meusRegistros.slice().reverse().map(h => `
                                            <tr class="border-b hover:bg-gray-50">
                                                <td class="p-3">${h.data}</td>
                                                <td class="p-3">${h.usuario}</td>
                                                <td class="p-3">${h.materia}</td>
                                                <td class="p-3 text-center">${h.acertos}/${h.total}</td>
                                                <td class="p-3 text-center"><span class="px-2 py-1 rounded ${h.perc >= 70 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">${h.perc}%</span></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        `}
                        
                        <button onclick="tela='menu';render()" class="w-full mt-6 p-3 border-2 border-gray-300 rounded-lg hover:bg-gray-50">Voltar</button>
                    </div>
                </div>
            `;
        }

        function renderInserir() {
            document.getElementById('app').innerHTML = `
                <div class="min-h-screen p-4">
                    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6">
                        <h1 class="text-2xl font-bold mb-6">‚ûï Inserir Nova Quest√£o</h1>
                        
                        <input type="text" id="materia" placeholder="Mat√©ria (ex: Hist√≥ria)" class="w-full p-3 border rounded mb-4">
                        <textarea id="pergunta" placeholder="Digite a pergunta" class="w-full p-3 border rounded mb-4" rows="3"></textarea>
                        
                        <div class="space-y-3 mb-4">
                            <input type="text" id="opcaoA" placeholder="Op√ß√£o A" class="w-full p-3 border rounded">
                            <input type="text" id="opcaoB" placeholder="Op√ß√£o B" class="w-full p-3 border rounded">
                            <input type="text" id="opcaoC" placeholder="Op√ß√£o C" class="w-full p-3 border rounded">
                            <input type="text" id="opcaoD" placeholder="Op√ß√£o D" class="w-full p-3 border rounded">
                        </div>
                        
                        <select id="correta" class="w-full p-3 border rounded mb-4">
                            <option value="">Selecione a resposta correta</option>
                            <option value="a">A</option>
                            <option value="b">B</option>
                            <option value="c">C</option>
                            <option value="d">D</option>
                        </select>
                        
                        <textarea id="explicacao" placeholder="Explica√ß√£o da resposta" class="w-full p-3 border rounded mb-4" rows="2"></textarea>
                        
                        <div class="flex gap-3">
                            <button onclick="inserirQuestao()" class="flex-1 p-3 bg-green-500 text-white rounded-lg hover:bg-green-600">Salvar Quest√£o</button>
                            <button onclick="tela='menu';render()" class="flex-1 p-3 border-2 border-gray-300 rounded-lg hover:bg-gray-50">Cancelar</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Fun√ß√µes
        function cadastrar() {
            const nome = document.getElementById('nome').value.trim();
            const usuario = document.getElementById('usuario').value.trim();
            const senha = document.getElementById('senha').value;
            const senha2 = document.getElementById('senha2').value;
            const perfil = document.getElementById('perfil').value;
            const professor = perfil === 'aluno' ? document.getElementById('professor').value.trim() : '';

            if (!nome || !usuario || !senha || !senha2) {
                alert('‚ùå Preencha todos os campos!');
                return;
            }
            if (perfil === 'aluno' && !professor) {
                alert('‚ùå Informe o professor respons√°vel!');
                return;
            }
            if (senha !== senha2) {
                alert('‚ùå As senhas n√£o coincidem!');
                return;
            }
            if (usuarios.find(u => u.usuario === usuario)) {
                alert('‚ùå Usu√°rio j√° existe!');
                return;
            }

            usuarios.push({
                id: Date.now(), 
                nome, 
                usuario, 
                senha, 
                perfil, 
                professor: professor || ''
            });
            salvar();
            alert('‚úÖ Cadastro realizado com sucesso!');
            tela = 'login';
            render();
        }

        function login() {
            const usuario = document.getElementById('usuario').value.trim();
            const senha = document.getElementById('senha').value;
            const user = usuarios.find(u => u.usuario === usuario && u.senha === senha);
            
            if (user) {
                usuarioLogado = user;
                tela = 'menu';
                render();
            } else {
                alert('‚ùå Usu√°rio ou senha incorretos!');
            }
        }

        function sair() {
            if (confirm('Deseja realmente sair?')) {
                usuarioLogado = null;
                tela = 'cadastro';
                render();
            }
        }

        function iniciarQuiz(materia) {
            const questoesFiltradas = questoes.filter(q => q.materia === materia);
            quizAtual = {
                materia: materia,
                questoes: questoesFiltradas,
                indice: 0,
                respostas: []
            };
            tela = 'quiz';
            render();
        }

        function responder(opcao) {
            const q = quizAtual.questoes[quizAtual.indice];
            const correta = opcao === q.correta;
            
            quizAtual.respostas.push({
                pergunta: q.pergunta,
                resposta: q.opcoes[opcao],
                opcaoCorreta: q.opcoes[q.correta],
                correta: correta,
                explicacao: q.explicacao
            });
            
            quizAtual.indice++;
            
            if (quizAtual.indice < quizAtual.questoes.length) {
                render();
            } else {
                finalizarQuiz();
            }
        }

        function finalizarQuiz() {
            const acertos = quizAtual.respostas.filter(r => r.correta).length;
            const total = quizAtual.questoes.length;
            const perc = Math.round((acertos / total) * 100);
            
            const registro = {
                data: new Date().toLocaleString('pt-BR'),
                usuario: usuarioLogado.nome,
                login: usuarioLogado.usuario,
                perfil: usuarioLogado.perfil,
                professor: usuarioLogado.professor || usuarioLogado.nome,
                materia: quizAtual.materia,
                total: total,
                acertos: acertos,
                perc: perc
            };
            
            historico.push(registro);
            salvar();
            
            tela = 'resultado';
            render();
        }

        function inserirQuestao() {
            const materia = document.getElementById('materia').value.trim();
            const pergunta = document.getElementById('pergunta').value.trim();
            const opcaoA = document.getElementById('opcaoA').value.trim();
            const opcaoB = document.getElementById('opcaoB').value.trim();
            const opcaoC = document.getElementById('opcaoC').value.trim();
            const opcaoD = document.getElementById('opcaoD').value.trim();
            const correta = document.getElementById('correta').value;
            const explicacao = document.getElementById('explicacao').value.trim();

            if (!materia || !pergunta || !opcaoA || !opcaoB || !opcaoC || !opcaoD || !correta || !explicacao) {
                alert('‚ùå Preencha todos os campos!');
                return;
            }

            const novaQuestao = {
                id: Date.now(),
                materia,
                pergunta,
                opcoes: {a: opcaoA, b: opcaoB, c: opcaoC, d: opcaoD},
                correta,
                explicacao
            };

            questoes.push(novaQuestao);
            salvar();
            alert('‚úÖ Quest√£o inserida com sucesso!');
            tela = 'menu';
            render();
        }

        function gerarDOC() {
            const meusRegistros = usuarioLogado.perfil === 'professor' 
                ? historico 
                : historico.filter(h => h.login === usuarioLogado.usuario);
                
            if (meusRegistros.length === 0) {
                alert('‚ùå Fa√ßa um quiz primeiro!');
                return;
            }
            
            const ultimo = meusRegistros[meusRegistros.length - 1];
            let html = '<html><head><meta charset="utf-8"><title>Relat√≥rio Quiz</title></head>';
            html += '<body style="font-family:Arial;margin:40px;">';
            html += '<h1 style="text-align:center;color:#2563eb;">RELAT√ìRIO DE DESEMPENHO - QUIZ</h1>';
            html += '<hr style="margin:20px 0;">';
            html += '<p><strong>Nome:</strong> ' + ultimo.usuario + '</p>';
            html += '<p><strong>Usu√°rio:</strong> @' + ultimo.login + '</p>';
            html += '<p><strong>Perfil:</strong> ' + ultimo.perfil + '</p>';
            html += '<p><strong>Professor:</strong> ' + ultimo.professor + '</p>';
            html += '<p><strong>Mat√©ria:</strong> ' + ultimo.materia + '</p>';
            html += '<p><strong>Data:</strong> ' + ultimo.data + '</p>';
            html += '<hr style="margin:20px 0;">';
            html += '<h2 style="color:#2563eb;">Resultado:</h2>';
            html += '<p><strong>Total de Quest√µes:</strong> ' + ultimo.total + '</p>';
            html += '<p><strong>Acertos:</strong> ' + ultimo.acertos + '</p>';
            html += '<p><strong>Percentual:</strong> <span style="font-size:24px;color:' + (ultimo.perc >= 70 ? 'green' : 'red') + ';">' + ultimo.perc + '%</span></p>';
            html += '<p><strong>Status:</strong> ' + (ultimo.perc >= 70 ? '‚úÖ APROVADO' : '‚ùå PRECISA MELHORAR') + '</p>';
            html += '</body></html>';
            
            const blob = new Blob(['\ufeff' + html], {type: 'application/msword'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Relatorio_Quiz_' + ultimo.login + '_' + Date.now() + '.doc';
            a.click();
            URL.revokeObjectURL(url);
            alert('‚úÖ Relat√≥rio DOC gerado com sucesso!');
        }

        function gerarCSV() {
            const meusRegistros = usuarioLogado.perfil === 'professor' 
                ? historico 
                : historico.filter(h => h.login === usuarioLogado.usuario);
                
            if (meusRegistros.length === 0) {
                alert('‚ùå Sem hist√≥rico para gerar planilha!');
                return;
            }
            
            let csv = 'Data,Nome,Usuario,Perfil,Professor,Materia,Total Questoes,Acertos,Percentual,Status\n';
            meusRegistros.forEach(h => {
                const status = h.perc >= 70 ? 'Aprovado' : 'Precisa Melhorar';
                csv += `"${h.data}","${h.usuario}","${h.login}","${h.perfil}","${h.professor}","${h.materia}",${h.total},${h.acertos},${h.perc}%,"${status}"\n`;
            });
            
            const blob = new Blob(['\ufeff' + csv], {type: 'text/csv;charset=utf-8;'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Historico_Quiz_' + usuarioLogado.usuario + '_' + Date.now() + '.csv';
            a.click();
            URL.revokeObjectURL(url);
            alert('‚úÖ Planilha CSV gerada com sucesso!');
        }

        // Iniciar aplica√ß√£o
        render();
    </script>
</body>
</html>
